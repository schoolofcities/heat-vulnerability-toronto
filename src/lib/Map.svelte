<script>

    import { onMount } from 'svelte';
    import maplibregl from 'maplibre-gl';
    import * as pmtiles from 'pmtiles';
    import layers from 'protomaps-themes-base';

	let map;
    let PMTILES_URL = "./toronto.pmtiles";

    let protocol = new pmtiles.Protocol();
    maplibregl.addProtocol('pmtiles', protocol.tile);


    onMount(() => {

        map = new maplibregl.Map({
            container: 'map',
            center: [-79.36, 43.715],
            zoom: 10.5, 
            minZoom: 9,
            maxZoom: 13,
            bearing: -17,
            maxBounds:[ 
                [-80.28, 43.21], 
                [-77.88, 44.91] 
            ],
            projection: 'globe',
            scrollZoom: true,
            attributionControl: false,
            showZoom: true,
        });

        map.addSource('protomaps', {
            type: "vector",
            url: "pmtiles://" + PMTILES_URL,
            attribution: 'Â© <a href="https://openstreetmap.org">OpenStreetMap</a>'
        });

        let protoLayers = layers("protomaps","light");

        protoLayers.forEach(e => {
            map.addLayer(e);
        });
        

    });

</script>

<div id="map" style="height: 700px"></div>